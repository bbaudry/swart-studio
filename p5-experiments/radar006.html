<!DOCTYPE html>
<html lang="en">
<html>

<head>
    <meta charset="UTF-8">
    <script src="https://cdn.jsdelivr.net/npm/p5@1.6.0/lib/p5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tone@14.7.77/build/Tone.min.js"></script>
    <style>
        body {
            padding: 0;
            margin: 0;
        }
    </style>
</head>

<body>
    <script>
        //global vars for the whole piece
        var w = document.documentElement.clientWidth;//width of window that is available for drawing
        var h = document.documentElement.clientHeight;//width of window that is available for drawing
        var spokes1 = [];
        var spokes2 = [];
        var free;
        var resolution;

        function preload() {
            free = loadFont('fonts/FreeMono.ttf');
        }

        function setup() {
            colorMode(HSB, 360, 100, 100, 250);
            let canvas = createCanvas(w, h);
            textFont(free);
            textSize(42);
            resolution=42;
            initSpokes();
        }

        function initSpokes(){
            let step=(2*PI)/resolution
            let a, r
            let cx=w/2
            let cy=h/2
            for (i=0;i<resolution;i++){
                r=0.45*h+random()*(0.05*h) 
                a=i*step;
                spokes1.push({rad:r,x:cx,y:cy,angle:a})
            }
            for (i=0;i<resolution;i++){
                r=0.45*h+random()*(0.05*h) 
                a=i*step;
                spokes2.push({rad:r,x:cx,y:cy,angle:a})
            }
        }

        function draw() {
            background(0,0,0)
            drawSpokes()
            testBezier()
        }

        function testBezier(){
            noFill()
            strokeWeight(3)
            stroke(0,100,100)
            let x1=150; let y1=100;
            let x2=50; let y2=200
            ellipse(x1,y1,5,5)
            ellipse(x2,y2,5,5)
            //x1>x2 && y2>y1
            bezier(x1,y1,x1-(x1-x2),y1,x2,y2-((y2-y1)*0.3),x2,y2)
            bezier(x1,y1,x1,y2,x2,y1,x2,y2)
            stroke(90,100,100)
            x1=50; x2=150; y1=250; y2= 350
            ellipse(x1,y1,5,5)
            ellipse(x2,y2,5,5)
            //x1<x2 && y2>y1
            bezier(x1,y1,x1,y2,x2,y1,x2,y2)
        }

        function drawSpokes(){
            noFill()
            stroke(0,0,100)
            let x1,y1,x2,y2;
            for (i=1;i<resolution;i++){
                x1=spokes1[i-1].x+spokes1[i-1].rad*cos(spokes1[i-1].angle)
                y1=spokes1[i-1].y+spokes1[i-1].rad*sin(spokes1[i-1].angle)
                x2=spokes1[i].x+spokes1[i].rad*cos(spokes1[i].angle)
                y2=spokes1[i].y+spokes1[i].rad*sin(spokes1[i].angle)
                //bezier(x1,y1,x2,y2+42,x1,y1-42,x2,y2)  
                bezier(x1,y1,x1,y2,x2,y1,x2,y2)              
            }
            x1=spokes1[resolution-1].x+spokes1[resolution-1].rad*cos(spokes1[resolution-1].angle)
            y1=spokes1[resolution-1].y+spokes1[resolution-1].rad*sin(spokes1[resolution-1].angle)
            x2=spokes1[0].x+spokes1[0].rad*cos(spokes1[0].angle)
            y2=spokes1[0].y+spokes1[0].rad*sin(spokes1[0].angle)
            bezier(x1,y1,x2,y2+42,x1,y1-42,x2,y2)                
            moveSpokes()
            stroke(0,100,100)
            for (i=1;i<resolution;i++){
                x1=spokes2[i-1].x+spokes2[i-1].rad*cos(spokes2[i-1].angle)
                y1=spokes2[i-1].y+spokes2[i-1].rad*sin(spokes2[i-1].angle)
                x2=spokes2[i].x+spokes2[i].rad*cos(spokes2[i].angle)
                y2=spokes2[i].y+spokes2[i].rad*sin(spokes2[i].angle)
                bezier(x1,y1,x2,y2+42,x1,y1-42,x2,y2)                
            }
            x1=spokes2[resolution-1].x+spokes2[resolution-1].rad*cos(spokes2[resolution-1].angle)
            y1=spokes2[resolution-1].y+spokes2[resolution-1].rad*sin(spokes2[resolution-1].angle)
            x2=spokes2[0].x+spokes2[0].rad*cos(spokes2[0].angle)
            y2=spokes2[0].y+spokes2[0].rad*sin(spokes2[0].angle)
            bezier(x1,y1,x2,y2+42,x1,y1-42,x2,y2)                
            moveSpokes()    
        }

        function moveSpokes(){     
            for (i=0;i<resolution;i++){
                let p = 0.1*h
                spokes1[i].rad+=3-random()*6
                spokes2[i].rad+=3-random()*6
            }
        }

        function windowResized() {
            w = document.documentElement.clientWidth;//width of window that is available for drawing
            h = document.documentElement.clientHeight;//width of window that is available for drawing
            resizeCanvas(w, h);
        }

    </script>
</body>

</html>